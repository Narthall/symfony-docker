<?php

namespace App\Twig\Components\Back\Dashboard\Exploitation\Mega;

use App\Entity\BackUser;
use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use Symfony\Bundle\SecurityBundle\Security;
use Symfony\UX\LiveComponent\Attribute\AsLiveComponent;
use Symfony\UX\LiveComponent\Attribute\LiveAction;
use Symfony\UX\LiveComponent\Attribute\LiveArg;
use Symfony\UX\LiveComponent\Attribute\LiveProp;
use Symfony\UX\LiveComponent\DefaultActionTrait;
use Symfony\UX\LiveComponent\ValidatableComponentTrait;

#[AsLiveComponent]
class Records extends AbstractController
{
    use DefaultActionTrait;
    use ValidatableComponentTrait;

    private const NAME = 'Exploitation:Mega:Records';

    private const WIDGET_CODE = 'super_cb_records';

    private ?BackUser $backUser = null;

    #[LiveProp]
    public string $widget_title = "Dossiers";

    #[LiveProp]
    public string $invokerName = self::NAME;

    #[LiveProp]
    public Records_DisplayTab $displayTab = Records_DisplayTab::RECORDS_LATEST;


    public function __construct(
        private readonly Security $security,
    ) {}

    #[LiveAction]
    public function setDisplayTab(#[LiveArg] Records_DisplayTab $tabName): void
    {
        $this->displayTab = $tabName;
    }

    public function getData(): array
    {

        if (!$this->backUser) {
            $this->backUser = $this->security->getUser();
        }

        $data = match ($this->displayTab) {
            Records_DisplayTab::RECORDS_PENDING => $this->getTabPending(),
            Records_DisplayTab::RECORDS_LATE => $this->getTabLate(),
            default => $this->getTabLatest(),
        };

        return $data;
    }

    private function getTabLatest(): array
    {
        return [
            [
                'id' => 54,
                'firstName' => 'A',
                'lastName' => 'F',
                'stepName' => 'One',
            ],
            [
                'id' => 56,
                'firstName' => 'T',
                'lastName' => 'U',
                'stepName' => 'Two',
            ],
            [
                'id' => 58,
                'firstName' => 'M',
                'lastName' => 'C',
                'stepName' => 'Three',
            ],
            [
                'id' => 105,
                'firstName' => 'L',
                'lastName' => 'T',
                'stepName' => 'Four',
            ],
            [
                'id' => 107,
                'firstName' => 'G',
                'lastName' => 'B',
                'stepName' => 'Five',
            ],
            [
                'id' => 108,
                'firstName' => 'L',
                'lastName' => 'C',
                'stepName' => 'Six',
            ],
            [
                'id' => 110,
                'firstName' => 'M',
                'lastName' => 'T',
                'stepName' => 'Seven',
            ],
            [
                'id' => 113,
                'firstName' => 'J',
                'lastName' => 'S',
                'stepName' => 'Eight',
            ]
        ];
    }

    private function getTabPending(): array
    {
        return [
            [
                'id' => 55,
                'firstName' => 'A',
                'lastName' => 'F',
                'stepName' => 'One',
            ],
            [
                'id' => 56,
                'firstName' => 'T',
                'lastName' => 'U',
                'stepName' => 'Two',
            ],
            [
                'id' => 58,
                'firstName' => 'M',
                'lastName' => 'C',
                'stepName' => 'Three',
            ],
            [
                'id' => 105,
                'firstName' => 'L',
                'lastName' => 'T',
                'stepName' => 'Four',
            ],
            [
                'id' => 107,
                'firstName' => 'G',
                'lastName' => 'B',
                'stepName' => 'Five',
            ],
            [
                'id' => 108,
                'firstName' => 'L',
                'lastName' => 'C',
                'stepName' => 'Six',
            ],
            [
                'id' => 110,
                'firstName' => 'M',
                'lastName' => 'T',
                'stepName' => 'Seven',
            ],
            [
                'id' => 113,
                'firstName' => 'J',
                'lastName' => 'S',
                'stepName' => 'Eight',
            ]
        ];
    }

    private function getTabLate(): array
    {
        return [
            [
                'id' => 545,
                'firstName' => 'A',
                'lastName' => 'F',
                'stepName' => 'One',
            ],
            [
                'id' => 56,
                'firstName' => 'T',
                'lastName' => 'U',
                'stepName' => 'Two',
            ],
            [
                'id' => 58,
                'firstName' => 'M',
                'lastName' => 'C',
                'stepName' => 'Three',
            ],
            [
                'id' => 105,
                'firstName' => 'L',
                'lastName' => 'T',
                'stepName' => 'Four',
            ],
            [
                'id' => 107,
                'firstName' => 'G',
                'lastName' => 'B',
                'stepName' => 'Five',
            ],
            [
                'id' => 108,
                'firstName' => 'L',
                'lastName' => 'C',
                'stepName' => 'Six',
            ],
            [
                'id' => 110,
                'firstName' => 'M',
                'lastName' => 'T',
                'stepName' => 'Seven',
            ],
            [
                'id' => 113,
                'firstName' => 'J',
                'lastName' => 'S',
                'stepName' => 'Eight',
            ]
        ];
    }

    public function getSomeNumber(): int
    {
        return 1;
    }
}

